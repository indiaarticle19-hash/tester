<!DOCTYPE html>
<html>
<head>
    <title>Admin Panel</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 500px;
            margin: auto;
        }
        .box {
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 8px;
            margin-top: 20px;
        }
        input {
            width: 100%;
            padding: 10px;
            margin: 8px 0;
        }
        button {
            padding: 10px;
            width: 100%;
            cursor: pointer;
        }
    </style>
</head>
<body>

<h1>Admin Panel</h1>

<!-- LOGIN BOX -->
<div id="loginBox" class="box">
    <h3>Admin Login</h3>
    <input type="email" id="loginEmail" placeholder="Admin Email">
    <input type="password" id="loginPassword" placeholder="Password">
    <button onclick="login()">Login</button>
    <p id="loginMsg" style="color:red;"></p>
</div>

<!-- ADMIN PANEL (HIDDEN UNTIL LOGIN) -->
<div id="adminBox" class="box" style="display:none;">
    <h3>Add Product</h3>

    <input type="text" id="productName" placeholder="Product Name">
    <input type="text" id="productPrice" placeholder="Price">
    <input type="text" id="productImage" placeholder="Image URL (Paste Online Link)">
    
    <button onclick="addProduct()">Add Product</button>
    <p id="adminMsg" style="color:green;"></p>

    <button style="background:red; color:white; margin-top:15px;" onclick="logout()">Logout</button>
</div>

<!-- FIREBASE -->
<script type="module">
    // Firebase imports
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged }
        from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
    import { getFirestore, collection, addDoc }
        from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    // Your Config
    const firebaseConfig = {
        apiKey: "AIzaSyAj405kZSn-V6rOKE1BurRE3meYCGZ_wbU",
        authDomain: "prabha-graphics-7d269.firebaseapp.com",
        projectId: "prabha-graphics-7d269",
        storageBucket: "prabha-graphics-7d269.appspot.com",
        messagingSenderId: "968671773486",
        appId: "1:968671773486:web:234c477f4ba267f31770bf"
    };

    // Init Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // UI Elements
    const loginBox = document.getElementById("loginBox");
    const adminBox = document.getElementById("adminBox");
    const loginMsg = document.getElementById("loginMsg");
    const adminMsg = document.getElementById("adminMsg");

    // LOGIN FUNCTION
    window.login = function () {
        const email = document.getElementById("loginEmail").value;
        const pass = document.getElementById("loginPassword").value;

        signInWithEmailAndPassword(auth, email, pass)
            .then(() => {
                loginMsg.innerText = "";
            })
            .catch((error) => {
                loginMsg.innerText = "Invalid credentials!";
            });
    };

    // LOGOUT FUNCTION
    window.logout = function () {
        signOut(auth);
    };

    // AUTH STATE CHANGE
    onAuthStateChanged(auth, (user) => {
        if (user) {
            loginBox.style.display = "none";
            adminBox.style.display = "block";
        } else {
            loginBox.style.display = "block";
            adminBox.style.display = "none";
        }
    });

    // ADD PRODUCT FUNCTION
    window.addProduct = async function () {
        const name = document.getElementById("productName").value;
        const price = document.getElementById("productPrice").value;
        const image = document.getElementById("productImage").value;

        if (!name || !price || !image) {
            adminMsg.style.color = "red";
            adminMsg.innerText = "All fields required.";
            return;
        }

        await addDoc(collection(db, "products"), {
            name,
            price,
            image
        });

        adminMsg.style.color = "green";
        adminMsg.innerText = "Product Added!";
    };
</script>

</body>
</html>
